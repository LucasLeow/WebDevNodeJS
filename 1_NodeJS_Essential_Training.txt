-- Introduction --
	- JS thought as front-end tech (interactivity with Web apps)
		- eg: JS for Browser (DOM)
	- NodeJS, can use JS for Backend
		- Command line tools
		- Creating servers
		- Interacting with file system
		- Build Scalable event-driven applications

	- Can become fullstack with HTML, CSS and JS
	

-- 1 What is Node.js --

-- 1-1 Node.js History --
	- Created in 2009 as JS runtime based on Chrome VA engine
	- 2011: npm created
		- sharing of open-source node libraries
		- huge shift in how code was shared & maintained
	- 2015: Node.js Foundation created
		- Made up of several large companies
			- IBM, Microsoft, Paypal etc.
		- help maintain standards & growth of library
-- 1-2 Installing Node.js --

	- Current version: 
		- Include all latest features
		
	- LTS version:
		- most stable version


-- 2 Node Globals --
	- Explore what is commonly used in global namespace for typical Node.js files

-- 2-1 Inspecting global object --

	- In browser, global object called window
	- In NodeJS, global object called global
	- Global object contains:
		1) Objects
		2) Values
		3) Methods
		
		that can be used in any node.js files without having to import anything
	
	
	
		eg. console.log("Hello world");
		// same as global.console.log("Hello world");
		
	- variables created within a file have their namespace scoped to that file 
	eg. 
	
		let hello = "Hello from Node.js";
		console.log(global.hello) // is undefined because hello not scoped to global ns
		
		let name = "Lucas";
		console.log(`Hello ${name}`); // template string
		
-- 2-2 require() function --
	- typically used for importing other modules

	Some global methods and objects:
		const path = require("path");
		// "path" module, one of core modules in node.js
		// must import to use
		// "path" module used to work with paths

		
		const path = require("path");

		console.log(__dirname); // directory where file is located
		console.log(__filename); // current file path (entire)

		console.log(`The file name is ${path.basename(__filename)}`);
		
		for (let key in global) { // to view global objects
			console.log(key);
		}
		
		Bunch of global functions printed from global:
			global
			clearInterval
			clearTimeout
			setInterval
			setTimeout
			queueMicrotask
			performance
			clearImmediate
			setImmediate
			
-- 2-3 'process' global object --
	- can be accessed anywhere since its a global object 
	- to interact with current process instance
		- environment information 
		- read environment variables
		- communicate with terminal (collect info from terminal)
		- exit current process etc.
		
	Collect Info from terminal:
		- in process.argv array
		
	eg.
	
	console.log(process.argv);
	
	output:
	[
	  'C:\\Program Files\\nodejs\\node.exe',  'E:\\SelfLearning\\BackEnd\\JavaScript\\WebDevNodeJS_Course\\code\\2_Node_Globals\\2-3_processArgv.js'      
	] // path to node & path to file
	
	cmd: node 2-3_processArgv.js --user Lucas --greeting "Hello World"
	output: 
	
	[
	  'C:\\Program Files\\nodejs\\node.exe', 'E:\\SelfLearning\\BackEnd\\JavaScript\\WebDevNodeJS_Course\\code\\2_Node_Globals\\2-3_processArgv.js',     
	  '--user',
	  'Lucas',
	  '--greeting',
	  'Hello World'
	]
	
	function grab(flag) {
		let idxAfterFlag = process.argv.indexOf(flag) + 1; // indexOf returns idx of first occurrence of flag
		return process.argv[idxAfterFlag]; // idxAfterFlag contains the flag value
	}

	// provided flag is --greeting & --user respectively
	let greeting = grab("--greeting");
	let user = grab("--user");

	console.log(greeting); // Lucas
	console.log(user); // Hello World
	
-- 2-4 & 2-5 Standard Input & output --
	- Another feature of process object
	- To communicate with process while its running
	- process.stdout.write(`message to write to terminal`);
	- process.stdin.on("data", function_to_execute);
	
	eg.
	process.stdout.write("Writing to the terminal \n");
	
	const questions = [
		"What is your name?",
		"What is your favourite programming language?",
		"What is your hobby?"
	];
	
	const answers = [];
	
	function getAnswers(idx = 0) {
		process.stdout.write(`\n ${questions[idx]}`)
		process.stdout.write(` > `);
	}
	
	getAnswers()
	
	process.stdin.on("data", function(data) {
		answers.push(data.toString().trim());
		if (answers.length < questions.length) {
			getAnswers(answers.length);
		} else {
			process.exit();
		}
	});
	
	process.on("exit", () => {
		for (let i = 0; i < answers.length; i++) {
			process.stdout.write("\n");
			process.stdout.write(`Answer ${i+1} : ${answers[i]}`);
		}
	})
	
-- 2-6 Creating delay with setTimeout --
	- executes a function once after given time

	const waitTime = 3000; // 3000ms = 3s
	console.log(`Setting a ${waitTime / 1000} second delay`);
	
	setTimeout(() => {
		console.log("Timer elapsed");
	}, waitTime);
	
-- 2-7 setInterval --
	- same as setTimeout but executes function continuously after every interval
	
	
	* Refer to JSSyntax.txt : Timers to find out more details

-- 2-8 Using intervals as Progress bar --

	let currentTime = 0;
	let waitInterval = 500; // 0.5s
	let totalWaitTime = 5000; // 5s in total

	const incTime = () => {
		currentTime += waitInterval;
		const percentage = Math.floor((currentTime / totalWaitTime)* 100) ;
		process.stdout.clearLine();
		process.stdout.cursorTo(0);
		process.stdout.write(`waiting...${percentage}`);
	}

	setTimeout(() => {
		clearInterval(interval);
		process.stdout.write("\nLoading complete");
	}, totalWaitTime);

	let interval = setInterval(incTime, waitInterval);
	

-- 3 Node Modules -- 

-- 3-1 Understanding Core Modules --
	- const path = require("path"); // works with path 
	- const util = require("util"); // has util.log fn that provides timestamp etc.
	- const v8 = require("v8"); // to see memory usage of program


	- require() function to import core modules
	eg: 
		const path = require("path");
		const util = require("util");
		
		console.log(path.basename(__filename));
		
		const dirUploads = path.join(__dirname, "www", "files", "uploads");
		console.log(dirUploads);
		
		util.log(path.basename(__filename));
		
		util.log(v8.getHeapStatistics());
		
-- 3-2 Collecting info with "readline" module --
	- ask questions from terminal users
	- wrapper around stdin and stdout process
	
	eg.
	const readline = require("readline");
	const rl = readline.createInterface({
		input: process.stdin,
		output: process.stdout
		});
	
	rl.question("How do you like Node?", answer => {
		console.log(`Your answer: ${answer}`);
	})

-- 3-3 Using readline more effectively --

	- passing callback functions as arguments common in async JS
	eg.
	
	const readline = require("readline");
	const rl = readline.createInterface(
		{input: process.stdin,
		output: process.stdout
		}
	);

	const questions = [
		"What is your name?",
		"Where do you live?",
		"What are you doing later?"
	];

	function collectAnswers (questions, done) {
		const answers = [];

		const questionAnswered = answer => {
			answers.push(answer.trim());

			if (answers.length < questions.length) {
				rl.question(questions[answers.length], questionAnswered)
		   } else {
			   return done(answers);
		   }
		};
		rl.question(questions[0], questionAnswered);
	}

	collectAnswers(questions, function done(answers) {
		for(let i = 0; i < answers.length; i++) {
			console.log(answers[i]);
		}
		process.exit();
	})

-- 3-4 Exporting custom modules --
	- Every JS file is a module
	- modules are imported using the require() function
	- modules are exported using module.exports
	- all variables & functions in each file scoped to that module
	- variables and functions must be exported to be consumed by other files
	- modules can be published to npm to be shared
	- module.exports = (Whatever that should be returned) (can be single variable / function)
	eg.
	
	in customModule.js:
		let count = 0;
		const inc = () => ++count;
		const getCount = () => count;
		
		module.exports = {
			anything: true,
			who: "Lucas",
			count,
			inc,
			getCount
		};
		
	in app.js:
	
	const customModule = require("./customModule.js"); // if both file in same dir
	
	const {inc, getCount} = require("./customModule.js"); // import only the 2 fns
	
	console.log(customModule.anything); // prints true 
	console.log(customModule.inc()); //
	

-- 3-5 NodeJS Emitter Module --
	- Event emitter module: Node.js implementation of pub sub design pattern
	- require("events") module
		- create listeners and emit custom events
	- event emitter: tool to decouple logic & handle asynchronicity in JS
	
-- 3-6 Creating module from readline eg earlier --
	
	-- in collectAnswers.js --
	
		const readline = require("readline");
		const {EventEmitter} = require("events");

		const rl = readline.createInterface(
			{input: process.stdin,
			output: process.stdout
			}
		);

		module.exports = function collectAnswers (questions, done) {
			const answers = [];
			const emitter = new EventEmitter();

			const questionAnswered = answer => {
				answers.push(answer.trim());
				emitter.emit("answer", answer);

				if (answers.length < questions.length) {
					rl.question(questions[answers.length], questionAnswered)
			   } else {
				   return done(answers);
			   }
			};
			rl.question(questions[0], questionAnswered);
			return emitter;
		}

	
	-- in ask.js: --
	
		const collectAnswer = require("./3-6_collectAnswer");

		const questions = [
			"What is your name?",
			"Where do you live?",
			"What are you doing later?"
		];

		const answerEvents = collectAnswer(questions, function done(answers) {
			for(let i = 0; i < answers.length; i++) {
				console.log(answers[i]);
			}
			process.exit();
		});

		answerEvents.on("answer", answer => console.log(`The answer is ${answer}`));
		
	